# FastAPI Проект

Проект представляет собой REST API сервис, разработанный с использованием FastAPI. Сервис предоставляет функциональность для управления пользователями и их продуктами.

## Функциональность

- Управление пользователями (создание, получение, удаление)
- Управление продуктами (создание, получение, удаление)
- Связь между пользователями и их продуктами
- Валидация данных с использованием Pydantic
- Хранение данных в JSON файлах

## Технологии

- Python 3.11+
- FastAPI
- Pydantic
- Pytest
- Requests
- JSON Schema

## Хранение данных

Проект использует файловое хранилище на основе JSON файлов:
- `app/storage/users.json` - хранит данные пользователей
- `app/storage/products.json` - хранит данные продуктов


## Установка

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd fastApiProject
```

2. Создайте виртуальное окружение и активируйте его:
```bash
python -m venv venv
source venv/bin/activate  # для Linux/Mac
# или
venv\Scripts\activate  # для Windows
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Запуск

1. Запустите сервер:
```bash
uvicorn app.main:app --host 0.0.0.0 --port 8001 --reload
```

2. API будет доступно по адресу: http://localhost:8001/api/v1

## Тестирование

Для запуска тестов выполните:
```bash
pytest
```

Тесты включают:
- Проверку создания пользователей и продуктов
- Валидацию данных
- Проверку связей между пользователями и продуктами
- Обработку ошибок

## API Endpoints

### Пользователи

- `POST /api/v1/users` - Создание пользователя
- `GET /api/v1/users` - Получение списка всех пользователей
- `GET /api/v1/users/{user_id}` - Получение пользователя по ID
- `DELETE /api/v1/users/{user_id}` - Удаление пользователя

### Продукты

- `POST /api/v1/products` - Создание продукта
- `GET /api/v1/products` - Получение списка всех продуктов
- `GET /api/v1/products/{product_id}` - Получение продукта по ID
- `DELETE /api/v1/products/{product_id}` - Удаление продукта
- `GET /api/v1/users/{user_id}/products` - Получение продуктов пользователя
- `GET /api/v1/users/{user_id}/products/{product_id}` - Получение конкретного продукта пользователя

## Примеры использования

### Создание пользователя
```python
import requests

response = requests.post(
    "http://localhost:8001/api/v1/users",
    json={
        "id": 1,
        "name": "Иван",
        "surname": "Иванов",
        "birth_date": "01.01.1990",
        "products": []
    }
)
```

### Создание продукта
```python
response = requests.post(
    "http://localhost:8001/api/v1/products",
    json={
        "id": 1,
        "title": "Тестовый продукт",
        "description": "Описание продукта",
        "price": 100.0,
        "user_id": 1
    }
)
```

## Валидация данных

API использует Pydantic для валидации данных. Примеры валидации:

- Дата рождения должна быть в формате "DD.MM.YYYY"
- Цена продукта должна быть положительным числом
- ID пользователя должен существовать при создании продукта

## Обработка ошибок

API возвращает следующие коды состояния:
- 200: Успешный запрос
- 404: Ресурс не найден
- 422: Ошибка валидации данных
